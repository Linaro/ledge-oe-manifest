From 56377d36464a926600b17d9e8f485b8e3ea3b56c Mon Sep 17 00:00:00 2001
From: Maxim Uvarov <maxim.uvarov@linaro.org>
Date: Mon, 20 Jan 2020 19:22:52 +0000
Subject: [PATCH] wic: bootimg-efi: implement --include-path

--include-path can be used for placing files on ESP,
like dtbs.

Signed-off-by: Maxim Uvarov <maxim.uvarov@linaro.org>
---
 scripts/lib/wic/plugins/source/bootimg-efi.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/scripts/lib/wic/plugins/source/bootimg-efi.py b/scripts/lib/wic/plugins/source/bootimg-efi.py
index 2cfdc10ecd..fa320a50b8 100644
--- a/openembedded-core/scripts/lib/wic/plugins/source/bootimg-efi.py
+++ b/openembedded-core/scripts/lib/wic/plugins/source/bootimg-efi.py
@@ -289,6 +289,10 @@ class BootimgEFIPlugin(SourcePlugin):
         mcopy_cmd = "mcopy -i %s -s %s/* ::/" % (bootimg, hdddir)
         exec_native_cmd(mcopy_cmd, native_sysroot)
 
+        for path in part.include_path:
+            mcopy_cmd = "mcopy -i %s -s %s/ ::/" % (bootimg, path)
+            exec_native_cmd(mcopy_cmd, native_sysroot)
+
         chmod_cmd = "chmod 644 %s" % bootimg
         exec_cmd(chmod_cmd)
 
-- 
2.17.1

